<script type="text/javascript">
    function generate() {
        try {
            var recorder_factory = new ActiveXObject("ADSDK.RecorderFactory");
            if (recorder_factory != null)
                alert("Successfully created RecorderFactory object!");
            else
                alert("Error when creating RecorderFactory object!");
        }
        catch (e) {
            alert(e);
        }
    }

    function setStyle(id) {
        //window.alert(id);
        document.getElementById(id).parentNode.style.borderWidth = '5px';
        document.getElementById(id).parentNode.style.borderStyle = 'Solid';
        document.getElementById(id).parentNode.style.borderColor = 'yellow';
    }

    function unsetStyle(id) {
        document.getElementById(id).parentNode.style.borderWidth = '5px';
        document.getElementById(id).parentNode.style.borderStyle = 'Solid';
        document.getElementById(id).parentNode.style.borderColor = 'black';
    }

  //window.onload = generate;
</script>

<table id="home_table" border='1'>
  <tr>
    <td>
      <button id="live">Live View</button>
      <br>
      <button id="playback">Playback</button>
    </td>
    <td>
      <button id="grid_1">1x1</button>
    </td>
    <td>
      <button id="grid_4">2x2</button>
    </td>
    <td>
      <button id="grid_9">3x3</button>
    </td>
    <td>
      <button id="grid_16">4x4</button>
    </td>
    <td>
      <button id="grid_1+12">1+12</button>
    </td>
    <td>
      <button id="grid_1+8">1+8</button>
    </td>
  </tr>
  <tr>
    <td>
      <ol class="tree">

        <% @warehouse = Warehouse::all.first unless @warehouse %>

        <% @warehouse.servers.each do |server| %>
            <li>
              <label for="<%= server.id %>"><%= server.label %></label> <input type="checkbox" id="<%= server.id %>>"/>
              <ol>
                <% server.cameras.each do |camera| %>
                    <li class="file"><a href="#"><%= camera.label %></a></li>
                <% end %>
              </ol>
            </li>
        <% end %>
      </ol>
    </td>
    <td colspan="6" rowspan="2">
      <div id="video_object" style='text-align: center; padding: 5px'>
        <object classid='clsid:37BEA57F-131B-49C1-B6FB-6D9E78F41B19'
                width='320'
                height='240'
                id='AxVideoControl'
                EnableJavaScript='true'
                codebase='ADSDK.IVideoControl'>
          <p>Plugin American Dynamics SDK não foi encontrado.<br/>
            <a href='vs3_plugin_setup.zip'>Clique aqui</a> para instalá-lo.</p>
        </object>
        <script type="text/vbscript">
          <!--
              Sub AxVideoControlStart()
                  MsgBox "Within AxVideoControlStart"

                  camera_id = 28
                  address  = "201.64.223.142"
                  username = "admin"
                  password = "ibtech"

                  LayoutX1 = "<?xml version='1.0' encoding='utf-8' ?><Layout xmlns='urn:VideoLayoutSchema' Name='1x1' Rows='1' Columns='1' AspectRatio=':3'><Pane Id='0' RowSpan='1' ColumnSpan='1' RowNumber='0' ColumnNumber='0' IsMasterPane='true' /></Layout>"

                  AxVideoControl.SetPaneLayout LayoutX1
                  AxVideoControl.MediaStreamRender 0, "wnvr://" & username & ":" & password & "@" & address & "/media/" & camera_id & "/video/0"

                  StartPTZ()
              End Sub

              Sub StartPTZ()
                MsgBox "Within StartPTZ"
                'Set vidPTZ = AxVideoControl.GetInterface("ADSDK.IPtz")
                'Dim resultCode
                'resultCode = vidPTZ.StartSession(28)
                'MsgBox( resultCode )
                MsgBox( "After StartSession call" )
                'If ( tmp ) Then
                '    MsgBox "Okay!"
                'Else
                '    MsgBox "Oh no!"
                'End If
              End Sub
            -->
        </script>
        <br>
        <button id="select" onclick="AxVideoControlStart()">Selecionar</button>
        <button id="clear" onclick="unsetStyle(this.id)">Apagar</button>
      </div>
    </td>
  </tr>
  <tr>
    <td>
      <table>
        <tr>
          <td colspan="3">
            <button>UP</button>
          </td>
        </tr>
        <tr>
          <td rowspan="2">
            <button>LEFT</button>
          </td>
          <td>
            <button>ZOOM IN</button>
          </td>
          <td rowspan="2">
            <button>RIGHT</button>
          </td>
        </tr>
        <tr>
          <td>
            <button>ZOOM OUT</button>
          </td>
        </tr>
        <tr>
          <td colspan="3">
            <button>DOWN</button>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>

<br>