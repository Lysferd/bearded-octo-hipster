<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>VideoEdge NVR Web Sample</title>
</head>
<body>
    <table style="border: thin solid #C0C0C0; width: 1000; height: 700;" align="center">
        <colgroup>
            <col width="100%" />
            <col width="width:300px;" />
        </colgroup>
        <tr>
            <td colspan="2" style="height: 30px; vertical-align: top; border: 0px 0px 0px 0px;
                padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px">
                <table style="width: 100%; height: 100%; border: 0px; padding: 0px; margin: 0px;">
                    <tr style="color: #0066CC; background-color: #C0C0C0; font-weight: bold;">
                        <td align="right" style="width: 93px;">
                            URI:
                        </td>
                        <td id="_streamUrl">
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td id="qtDivObj" align="center" valign="middle" style="border-right-style: solid; border-right-width: thin; border-right-color: #C0C0C0; background-color: #000;">
            <div align="center">
            <object classid="clsid:37BEA57F-131B-49C1-B6FB-6D9E78F41B19"
                                height=600 width=800 id="AxVideoControl">
            </object>
            </div>
            </td>

            <td style="vertical-align: top;">
                <table style="width: 300px;">
                    <tr>
                        <td style="width: 100%; background-color: #C0C0C0; color: #0066CC; font-weight: bold;">
                            Stream Information
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 100%">
                            <table style="width: 100%;">
                                <tr>
                                    <td align="right" style="width: 97px; height: 26px;">
                                        Camera:
                                    </td>
                                    <td style="height: 26px;">
                                        <input id="_cameraNumber" name="CameraNumber" type="text" style="width: 100%" value="0"  />
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" style="width: 97px;">
                                        Address:
                                    </td>
                                    <td>
                                        <input id="_unitAddress" Name="UnitAddress" type="text" style="width: 100%;" value="192.168.200.47" />
                                    </td>
                                </tr>
                                <tr style="display:none">
                                    <td align="right" style="width: 97px;">
                                        Port:
                                    </td>
                                    <td>
                                        <input id="_mediaPort" name="MediaPort" type="text" value="554"  style="width: 80px;" />
                                        <input id="_defaultPortFlag" checked="true" type="checkbox" />Use
                                        Default
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" style="width: 97px;">
                                        User:
                                    </td>
                                    <td>
                                        <input id="_userName" name="UserName" type="text" style="width: 100%" value="admin" />
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" style="width: 97px;">
                                        Password:
                                    </td>
                                    <td>
                                        <input id="_password" name="Password" type="text" style="width: 100%" value="yumyum" />
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" style="width: 97px;">
                                        Is Intellex:
                                    </td>
                                    <td>
                                        <input id="_isIntellex" name="IsIntellex" type="checkbox" />
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" style="width: 97px;" title="yyyyMMddHHmmssFFF">
                                        Start time:
                                    </td>
                                    <td>
                                        <input id="_startTime" name="StartTime" type="text" style="width: 100%" value="2012061408010000" title="yyyyMMddHHmmssFFF" />
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" style="width: 97px;">
                                        Start paused:
                                    </td>
                                    <td>
                                        <input id="_startPaused" name="StartPaused" type="checkbox" />
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" style="width: 97px;">
                                        Start audio:
                                    </td>
                                    <td>
                                        <input id="_startAudio" name="StartAudio" type="checkbox" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 100%" align="center">
                            <input type="button" name="btnStart" value="Live Video Start" onclick ="vbscript:btnLiveStart_Click" />
                            <input type="button" name="btnStop" value="Live Video Stop" onclick ="vbscript:btnLiveStop_Click" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 100%" align="center">
                            <input type="button" name="btnTrickPlay" value="Tirck Play" onclick ="vbscript:btnTrickPlay_Click" />
                            <input type="button" name="btnTrickStop" value="Trick Stop" onclick ="vbscript:btnTrickStop_Click" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 100%" align="center">
                            <input type="button" name="btnStart" value="Start" onclick ="vbscript:btnStart_Click" />
                            <input type="button" name="btnStartEx" value="Start Ex" onclick ="vbscript:btnStartEx_Click" />
                            <input type="button" name="btnStop" value="Stop" onclick ="vbscript:btnStop_Click" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 100%" align="center">
                            <input type="button" name="btnReverse" value="<<<" onclick ="vbscript:btnReverse_Click" />
                            <input type="button" name="btnPlay" value="Play" onclick ="vbscript:btnPlay_Click" />
                            <input type="button" name="btnPause" value="Pause" onclick ="vbscript:btnPause_Click" />
                            <input type="button" name="btnForward" value=">>>" onclick ="vbscript:btnForward_Click" />
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 100%" align="center">
                            <input type="button" name="btnShow" value="Show" onclick ="vbscript:btnShow_Click" />
                            <input type="button" name="btnHide" value="Hide" onclick ="vbscript:btnHide_Click" />
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
<SCRIPT LANGUAGE="VBScript">
<!--

'Dim recorderFactory
'Dim recorder
'Dim notification
Dim StreamingIntefrace
Dim paneCount

Sub AxVideoControl_OnCreated(resultCode)
    
    ' 1x1
    ' AxVideoControl.SetPaneLayout "<?xml version='1.0' encoding='utf-8' ?>  <Layout xmlns='urn:VideoLayoutSchema' Name='1\D71' Rows='1' Columns='1' AspectRatio='4:3'>  <Pane Id='0' RowSpan='1' ColumnSpan='1' RowNumber='0' ColumnNumber='0' IsMasterPane='true' />  </Layout>"

    ' 2x2
    ' AxVideoControl.SetPaneLayout "<?xml version='1.0' encoding='utf-8' ?> <Layout xmlns='urn:VideoLayoutSchema' AspectRatio='4:3'  Orientation='' Name='2\D72' Rows='2' Columns='2'>   <Pane Id='0' RowSpan='1' ColumnSpan='1' RowNumber='0' ColumnNumber='0' IsMasterPane='true' /><Pane Id='1' RowSpan='1' ColumnSpan='1' RowNumber='0' ColumnNumber='1' IsMasterPane='false' /><Pane Id='2' RowSpan='1' ColumnSpan='1' RowNumber='1' ColumnNumber='0' IsMasterPane='false' /><Pane Id='3' RowSpan='1' ColumnSpan='1' RowNumber='1' ColumnNumber='1' IsMasterPane='false' /></Layout>"

    ' 3x3
    AxVideoControl.SetPaneLayout "<?xml version='1.0' encoding='utf-8' ?> <Layout xmlns='urn:VideoLayoutSchema' AspectRatio='4:3'  Orientation='' Name='3\D73' Rows='3' Columns='3'>   <Pane Id='0' RowSpan='1' ColumnSpan='1' RowNumber='0' ColumnNumber='0' IsMasterPane='true' /><Pane Id='1' RowSpan='1' ColumnSpan='1' RowNumber='0' ColumnNumber='1' IsMasterPane='false' /><Pane Id='2' RowSpan='1' ColumnSpan='1' RowNumber='0' ColumnNumber='2' IsMasterPane='false' /><Pane Id='3' RowSpan='1' ColumnSpan='1' RowNumber='1' ColumnNumber='0' IsMasterPane='false' /><Pane Id='4' RowSpan='1' ColumnSpan='1' RowNumber='1' ColumnNumber='1' IsMasterPane='false' /><Pane Id='5' RowSpan='1' ColumnSpan='1' RowNumber='1' ColumnNumber='2' IsMasterPane='false' /><Pane Id='6' RowSpan='1' ColumnSpan='1' RowNumber='2' ColumnNumber='0' IsMasterPane='false' /><Pane Id='7' RowSpan='1' ColumnSpan='1' RowNumber='2' ColumnNumber='1' IsMasterPane='false' /><Pane Id='8' RowSpan='1' ColumnSpan='1' RowNumber='2' ColumnNumber='2' IsMasterPane='false' /></Layout>"

    ' 4x4
    ' AxVideoControl.SetPaneLayout "<?xml version='1.0' encoding='utf-8' ?> <Layout xmlns='urn:VideoLayoutSchema' AspectRatio='4:3'  Orientation='' Name='4\D74' Rows='4' Columns='4'>   <Pane Id='0' RowSpan='1' ColumnSpan='1' RowNumber='0' ColumnNumber='0' IsMasterPane='true' /><Pane Id='1' RowSpan='1' ColumnSpan='1' RowNumber='0' ColumnNumber='1' IsMasterPane='false' /><Pane Id='2' RowSpan='1' ColumnSpan='1' RowNumber='0' ColumnNumber='2' IsMasterPane='false' /><Pane Id='3' RowSpan='1' ColumnSpan='1' RowNumber='0' ColumnNumber='3' IsMasterPane='false' /><Pane Id='4' RowSpan='1' ColumnSpan='1' RowNumber='1' ColumnNumber='0' IsMasterPane='false' /><Pane Id='5' RowSpan='1' ColumnSpan='1' RowNumber='1' ColumnNumber='1' IsMasterPane='false' /><Pane Id='6' RowSpan='1' ColumnSpan='1' RowNumber='1' ColumnNumber='2' IsMasterPane='false' /><Pane Id='7' RowSpan='1' ColumnSpan='1' RowNumber='1' ColumnNumber='3' IsMasterPane='false' /><Pane Id='8' RowSpan='1' ColumnSpan='1' RowNumber='2' ColumnNumber='0' IsMasterPane='false' /><Pane Id='9' RowSpan='1' ColumnSpan='1' RowNumber='2' ColumnNumber='1' IsMasterPane='false' /><Pane Id='10' RowSpan='1' ColumnSpan='1' RowNumber='2' ColumnNumber='2' IsMasterPane='false' /><Pane Id='11' RowSpan='1' ColumnSpan='1' RowNumber='2' ColumnNumber='3' IsMasterPane='false' /><Pane Id='12' RowSpan='1' ColumnSpan='1' RowNumber='3' ColumnNumber='0' IsMasterPane='false' /><Pane Id='13' RowSpan='1' ColumnSpan='1' RowNumber='3' ColumnNumber='1' IsMasterPane='false' /><Pane Id='14' RowSpan='1' ColumnSpan='1' RowNumber='3' ColumnNumber='2' IsMasterPane='false' /><Pane Id='15' RowSpan='1' ColumnSpan='1' RowNumber='3' ColumnNumber='3' IsMasterPane='false' /></Layout>"

    paneCount = 9
    btnTrickPlay.disabled = true
    btnTrickStop.disabled = true
    Set StreamingIntefrace = AxVideoControl.GetInterface("ADSDK.IStreaming")

    AxVideoControl.Resize

End Sub

Sub btnLiveStart_Click()

    Dim streamUri
    Dim cameraUri

    If IsIntellex.Checked Then
        streamUri = "ntlx://" & UnitAddress.Value
    Else
        streamUri = "nvr://" & UserName.Value
        streamUri = streamUri & ":" & Password.Value
        streamUri = streamUri & "@" & UnitAddress.Value
    End If

    For i = 0 To paneCount
        If IsIntellex.Checked Then
            cameraUri = streamUri & "/video/" & i
        Else
            cameraUri = streamUri & "/media/" & i
            cameraUri = cameraUri & "/video/0"
        End If

        AxVideoControl.MediaStreamRender i, cameraUri

    Next

    btnTrickPlay.disabled = false
    btnTrickStop.disabled = false

End Sub

Sub btnLiveStop_Click()

    For i = 0 To paneCount

        AxVideoControl.MediaStreamStop i

    Next

End Sub

Sub btnTrickPlay_Click()

    StreamingIntefrace.StreamingExecute 1

End Sub

Sub btnTrickStop_Click()

    StreamingIntefrace.StreamingStop

End Sub

Sub btnStart_Click()

'    Dim cameraUri
'    cameraUri = "rtsp://root:pass@192.168.200.7/axis-media/media.amp?videocodec=h264"

    Dim streamUri

    If IsIntellex.Checked Then
        streamUri = "ntlx://" & UnitAddress.Value
        streamUri = streamUri & "/video/" & CameraNumber.Value
    Else
        streamUri = "nvr://" & UserName.Value
        streamUri = streamUri & ":" & Password.Value
        streamUri = streamUri & "@" & UnitAddress.Value
        streamUri = streamUri & "/media/" & CameraNumber.Value
        streamUri = streamUri & "/video/0"
    End If


    Set vidControlEx = AxVideoControl.GetInterface("ADSDK.IStreamingPlayback")
    vidControlEx.OpenStream 0, streamUri, 10000
    vidControlEx = NULL

End Sub

Sub btnStartEx_Click()

    Dim streamUri

    If IsIntellex.Checked Then
        streamUri = "ntlx://" & UnitAddress.Value
        streamUri = streamUri & "/video/" & CameraNumber.Value
    Else
        streamUri = "nvr://" & UserName.Value
        streamUri = streamUri & ":" & Password.Value
        streamUri = streamUri & "@" & UnitAddress.Value
        streamUri = streamUri & "/media/" & CameraNumber.Value
        streamUri = streamUri & "/video/0"
    End If

    Set vidControlEx = AxVideoControl.GetInterface("ADSDK.IStreamingPlayback")
    vidControlEx.OpenStreamEx 0, streamUri, StartTime.Value, StartPaused.Checked, StartAudio.Checked, 10000
    vidControlEx = NULL

End Sub

Sub btnStop_Click()

    Set vidControlEx = AxVideoControl.GetInterface("ADSDK.IStreamingPlayback")
    vidControlEx.Stop
    vidControlEx = NULL

End Sub

Sub btnReverse_Click()

    Set vidControlEx = AxVideoControl.GetInterface("ADSDK.IStreamingPlayback")
    Dim action
    vidControlEx.Reverse action 
    vidControlEx = NULL

End Sub

Sub btnPlay_Click()

    Set vidControlEx = AxVideoControl.GetInterface("ADSDK.IStreamingPlayback")
    vidControlEx.Play
    vidControlEx = NULL

End Sub

Sub btnPause_Click()

    Set vidControlEx = AxVideoControl.GetInterface("ADSDK.IStreamingPlayback")
    vidControlEx.Pause
    vidControlEx = NULL

End Sub

Sub btnForward_Click()

    Set vidControlEx = AxVideoControl.GetInterface("ADSDK.IStreamingPlayback")
    Dim action
    vidControlEx.FastForward action
    vidControlEx = NULL

End Sub

Sub btnShow_Click()

    Set vidControlEx = AxVideoControl.GetInterface("ADSDK.IOverlay")
    vidControlEx.ShowAnalyticHitBox 0, 0.20, 0.20, 0.30, 0.30, 120
    vidControlEx = NULL

End Sub

Sub btnHide_Click()

    Set vidControlEx = AxVideoControl.GetInterface("ADSDK.IOverlay")
    vidControlEx.HideAnalyticHitBox 0
    vidControlEx = NULL

End Sub

-->
</SCRIPT>

</body>
</html>
